<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AgriTrade Africa - ULTIMATE v3.0 (Multilingual Investor Demo)</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary: #1b5e20; --primary-light: #4caf50; --accent: #ffc107;
      --purple: #9c27b0; --blue: #2196f3; --red: #f44336;
      --bg: #f5f5f5; --card: #ffffff; --text: #212121; --text-light: #757575;
      --shadow: 0 2px 8px rgba(0,0,0,0.1); --shadow-lg: 0 8px 32px rgba(0,0,0,0.15);
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
    }

    /* Loading Screen */
    #loader { position: fixed; inset: 0; background: var(--primary); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; transition: opacity 0.5s; }
    #loader.hidden { opacity: 0; pointer-events: none; }
    .loader-icon { font-size: 4rem; animation: bounce 1s infinite; margin-bottom: 1rem; }
    @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
    .loader-bar { width: 200px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 2px; overflow: hidden; }
    .loader-progress { height: 100%; width: 0%; background: var(--accent); transition: width 0.3s; }

    /* Layout */
    .app { display: grid; grid-template-columns: 260px 1fr 320px; min-height: 100vh; }

    /* Navigation */
    .navbar { position: fixed; top: 0; left: 0; right: 0; height: 64px; background: var(--primary); color: white; display: flex; align-items: center; justify-content: space-between; padding: 0 1.5rem; z-index: 100; box-shadow: var(--shadow); }
    .logo { font-size: 1.5rem; font-weight: bold; display: flex; align-items: center; gap: 0.5rem; }
    .nav-center { display: flex; gap: 0.5rem; }
    .nav-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
    .nav-btn:hover, .nav-btn.active { background: var(--accent); color: var(--text); }
    .nav-right { display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap; justify-content: flex-end; }
    select { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.4rem; border-radius: 6px; cursor: pointer; }
    .top-date {
      font-size: 0.85rem;
      opacity: 0.9;
      padding: 0.35rem 0.6rem;
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.15);
      white-space: nowrap;
    }

    /* Sidebar Left */
    .sidebar-left { background: var(--card); margin-top: 64px; padding: 1.5rem; border-right: 1px solid #e0e0e0; overflow-y: auto; }
    .user-card { text-align: center; padding-bottom: 1.5rem; border-bottom: 1px solid #e0e0e0; margin-bottom: 1.5rem; }
    .avatar { width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary), var(--primary-light)); border-radius: 50%; margin: 0 auto 1rem; display: flex; align-items: center; justify-content: center; font-size: 2rem; position: relative; }
    .avatar::after { content: ''; position: absolute; bottom: 5px; right: 5px; width: 12px; height: 12px; background: #4caf50; border: 2px solid white; border-radius: 50%; }
    .user-name { font-weight: bold; font-size: 1.1rem; }
    .user-level { color: var(--text-light); font-size: 0.875rem; margin-top: 0.25rem; }
    .xp-bar { height: 6px; background: #e0e0e0; border-radius: 3px; margin-top: 0.75rem; overflow: hidden; }
    .xp-fill { height: 100%; width: 75%; background: linear-gradient(90deg, var(--accent), #ff9800); border-radius: 3px; }

    .menu { list-style: none; }
    .menu-item { margin-bottom: 0.5rem; }
    .menu-link { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; color: var(--text); text-decoration: none; border-radius: 10px; transition: all 0.3s; cursor: pointer; }
    .menu-link:hover, .menu-link.active { background: var(--primary); color: white; }
    .menu-icon { width: 24px; text-align: center; }
    .badge { margin-left: auto; background: var(--red); color: white; font-size: 0.7rem; padding: 0.2rem 0.5rem; border-radius: 10px; }

    .section-title { font-size: 0.75rem; text-transform: uppercase; color: var(--text-light); margin: 1.5rem 0 0.75rem; font-weight: bold; letter-spacing: 0.5px; }

    /* Main Content */
    .main { margin-top: 64px; padding: 1.5rem; overflow-y: auto; max-height: calc(100vh - 64px); }

    /* Cards */
    .card { background: var(--card); border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--shadow); }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; gap: 0.75rem; flex-wrap: wrap; }
    .card-title { font-size: 1.1rem; font-weight: bold; display: flex; align-items: center; gap: 0.5rem; }

    /* AI Banner */
    .ai-banner { background: linear-gradient(135deg, #1a237e, #283593); color: white; border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem; }
    .ai-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; gap: 0.75rem; flex-wrap: wrap; }
    .ai-status { display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; }
    .pulse { width: 8px; height: 8px; background: #4caf50; border-radius: 50%; animation: pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .ai-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; text-align: center; }
    .ai-stat { background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 12px; }
    .ai-value { font-size: 1.5rem; font-weight: bold; color: var(--accent); }
    .ai-label { font-size: 0.75rem; opacity: 0.9; }
    .ai-tools { display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap; }
    .ai-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; font-size: 0.875rem; transition: all 0.3s; }
    .ai-btn:hover { background: var(--accent); color: var(--text); }

    /* Stats Grid */
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
    .stat-box { background: var(--card); padding: 1.25rem; border-radius: 12px; box-shadow: var(--shadow); position: relative; overflow: hidden; }
    .stat-box::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--primary); }
    .stat-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; gap: 0.75rem; }
    .stat-title { font-size: 0.875rem; color: var(--text-light); }
    .stat-icon { width: 40px; height: 40px; background: #e8f5e9; color: var(--primary); border-radius: 10px; display: flex; align-items: center; justify-content: center; }
    .stat-value { font-size: 1.75rem; font-weight: bold; color: var(--primary); }
    .stat-change { font-size: 0.875rem; color: #4caf50; display: flex; align-items: center; gap: 0.25rem; }

    /* Feature Grid */
    .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
    .feature-card { background: var(--card); border-radius: 12px; padding: 1.25rem; box-shadow: var(--shadow); cursor: pointer; transition: all 0.3s; border: 2px solid transparent; }
    .feature-card:hover { border-color: var(--primary); transform: translateY(-2px); }
    .feature-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.75rem; }
    .feature-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: white; }
    .feature-title { font-weight: bold; }
    .feature-desc { font-size: 0.875rem; color: var(--text-light); margin-bottom: 0.75rem; }
    .feature-actions { display: flex; gap: 0.5rem; }
    .btn { flex: 1; padding: 0.625rem; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
    .btn-primary { background: var(--primary); color: white; }
    .btn-secondary { background: #f5f5f5; color: var(--text); border: 1px solid #e0e0e0; }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }

    /* Scanner */
    .scanner { border: 2px dashed #e0e0e0; border-radius: 12px; padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s; }
    .scanner:hover { border-color: var(--primary); background: #f5f5f5; }
    .scanner-icon { font-size: 2.5rem; color: var(--text-light); margin-bottom: 0.5rem; }
    .scan-result { display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #4caf50; }

    /* Map */
    #map { height: 300px; border-radius: 12px; }

    /* Right Sidebar */
    .sidebar-right { background: var(--card); margin-top: 64px; padding: 1.5rem; border-left: 1px solid #e0e0e0; overflow-y: auto; }

    /* Wallet Card */
    .wallet { background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white; border-radius: 16px; padding: 1.5rem; margin-bottom: 1.5rem; position: relative; overflow: hidden; }
    .wallet::before { content: ''; position: absolute; top: -50%; right: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); }
    .wallet-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; position: relative; gap: 0.75rem; flex-wrap: wrap; }
    .wallet-label { font-size: 0.875rem; opacity: 0.9; }
    .wallet-balance { font-size: 2rem; font-weight: bold; margin-bottom: 1rem; position: relative; }
    .wallet-actions { display: flex; gap: 0.5rem; position: relative; }
    .wallet-btn { flex: 1; background: rgba(255,255,255,0.2); border: none; color: white; padding: 0.625rem; border-radius: 8px; cursor: pointer; font-size: 0.875rem; transition: all 0.3s; }
    .wallet-btn:hover { background: rgba(255,255,255,0.3); }

    /* Chat */
    .chat { background: var(--card); border-radius: 16px; overflow: hidden; box-shadow: var(--shadow); height: 400px; display: flex; flex-direction: column; }
    .chat-header { background: var(--primary); color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .chat-tabs { display: flex; background: #f5f5f5; }
    .chat-tab { flex: 1; padding: 0.75rem; text-align: center; cursor: pointer; font-size: 0.875rem; font-weight: 600; border-bottom: 2px solid transparent; }
    .chat-tab.active { background: white; border-bottom-color: var(--primary); color: var(--primary); }
    .chat-messages { flex: 1; overflow-y: auto; padding: 1rem; display: flex; flex-direction: column; gap: 0.75rem; }
    .message { display: flex; gap: 0.5rem; max-width: 85%; }
    .message.own { align-self: flex-end; flex-direction: row-reverse; }
    .msg-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: bold; flex-shrink: 0; }
    .msg-bubble { padding: 0.625rem 0.875rem; border-radius: 12px; font-size: 0.875rem; }
    .msg-bubble.other { background: #f5f5f5; border-bottom-left-radius: 4px; }
    .msg-bubble.own { background: var(--primary); color: white; border-bottom-right-radius: 4px; }
    .msg-bubble.ai { background: linear-gradient(135deg, var(--purple), #e91e63); color: white; border-bottom-left-radius: 4px; }
    .chat-input { padding: 0.875rem; border-top: 1px solid #e0e0e0; display: flex; gap: 0.5rem; }
    .chat-input input { flex: 1; border: 1px solid #e0e0e0; border-radius: 20px; padding: 0.5rem 1rem; outline: none; }
    .chat-input button { width: 36px; height: 36px; border-radius: 50%; background: var(--primary); color: white; border: none; cursor: pointer; }

    /* Gamification */
    .badges { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; margin-top: 1rem; }
    .badge-item { text-align: center; padding: 0.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; user-select: none; }
    .badge-item:hover { background: #f5f5f5; transform: scale(1.05); }
    .badge-icon { font-size: 1.5rem; }
    .badge-name { font-size: 0.65rem; color: var(--text-light); }
    .badge-item.locked { opacity: 0.4; filter: grayscale(1); }
    .badge-item.unlock-anim { animation: pop 0.5s ease; }
    @keyframes pop {
      0% { transform: scale(0.9); }
      60% { transform: scale(1.12); }
      100% { transform: scale(1); }
    }

    /* Mobile Money */
    .mm-options { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
    .mm-option { flex: 1; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 10px; text-align: center; cursor: pointer; transition: all 0.3s; }
    .mm-option.active { border-color: var(--primary); background: #e8f5e9; }
    .mm-form { display: flex; flex-direction: column; gap: 0.75rem; }
    .input { padding: 0.75rem; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 1rem; }
    .input:focus { outline: none; border-color: var(--primary); }

    /* Modal */
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; padding: 1rem; }
    .modal.active { display: flex; }
    .modal-content { background: white; border-radius: 16px; width: 100%; max-width: 500px; max-height: 90vh; overflow-y: auto; animation: modalIn 0.3s; }
    @keyframes modalIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .modal-header { background: var(--primary); color: white; padding: 1.25rem; display: flex; justify-content: space-between; align-items: center; gap: 0.75rem; flex-wrap: wrap; }
    .modal-close { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
    .modal-body { padding: 1.5rem; }

    /* Toast */
    .toast-container { position: fixed; top: 80px; right: 20px; z-index: 2000; display: flex; flex-direction: column; gap: 0.5rem; }
    .toast { background: white; padding: 1rem 1.25rem; border-radius: 10px; box-shadow: var(--shadow-lg); display: flex; align-items: center; gap: 0.75rem; animation: toastIn 0.3s; border-left: 4px solid var(--primary); min-width: 300px; max-width: 360px; }
    @keyframes toastIn { from { transform: translateX(100%); opacity: 0.7; } to { transform: translateX(0); opacity: 1; } }
    .toast.success { border-left-color: #4caf50; }
    .toast.error { border-left-color: var(--red); }
    .toast.info { border-left-color: var(--blue); }

    /* Voice Overlay */
    .voice-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 3000; flex-direction: column; align-items: center; justify-content: center; color: white; }
    .voice-overlay.active { display: flex; }
    .voice-circle { width: 120px; height: 120px; border-radius: 50%; background: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 2.5rem; animation: voicePulse 1.5s infinite; margin-bottom: 2rem; }
    @keyframes voicePulse { 0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(27,94,32,0.7); } 50% { transform: scale(1.1); box-shadow: 0 0 0 30px rgba(27,94,32,0); } }

    /* Floating Buttons */
    .fab { position: fixed; bottom: 90px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background: var(--accent); border: none; font-size: 1.5rem; cursor: pointer; box-shadow: var(--shadow-lg); z-index: 99; transition: all 0.3s; }
    .fab:hover { transform: scale(1.1); }
    .fab-menu { position: fixed; bottom: 160px; right: 20px; display: flex; flex-direction: column; gap: 0.75rem; opacity: 0; pointer-events: none; transition: all 0.3s; z-index: 99; }
    .fab-menu.active { opacity: 1; pointer-events: all; }
    .fab-item { display: flex; align-items: center; gap: 0.75rem; }
    .fab-small { width: 44px; height: 44px; border-radius: 50%; border: none; color: white; font-size: 1rem; cursor: pointer; }
    .fab-label { background: var(--text); color: white; padding: 0.375rem 0.75rem; border-radius: 6px; font-size: 0.75rem; white-space: nowrap; }

    /* Responsive */
    @media (max-width: 1200px) { .app { grid-template-columns: 1fr; } .sidebar-left, .sidebar-right { display: none; } }
    @media (max-width: 768px) { .stats-grid, .feature-grid { grid-template-columns: 1fr; } .ai-grid { grid-template-columns: repeat(2, 1fr); } }

    /* RTL support */
    [dir="rtl"] body { text-align: right; }
    [dir="rtl"] .sidebar-left { border-right: none; border-left: 1px solid #e0e0e0; }
    [dir="rtl"] .sidebar-right { border-left: none; border-right: 1px solid #e0e0e0; }
    [dir="rtl"] .toast-container { right: auto; left: 20px; }
    [dir="rtl"] .fab { right: auto; left: 20px; }
    [dir="rtl"] .fab-menu { right: auto; left: 20px; }
    [dir="rtl"] .message.own { align-self: flex-end; flex-direction: row; }
    [dir="rtl"] .message { flex-direction: row-reverse; }
  </style>
</head>

<body>
  <!-- Loading Screen -->
  <div id="loader">
    <div class="loader-icon">üåæ</div>
    <h2 data-i18n="appName">AgriTrade Africa</h2>
    <p style="margin: 1rem 0; opacity: 0.8;" data-i18n="loadingExperience">Loading Ultimate Experience...</p>
    <div class="loader-bar"><div class="loader-progress" id="loaderProgress"></div></div>
    <p style="margin-top: 1rem; font-size: 0.875rem; opacity: 0.7;" id="loaderText" data-i18n="loaderInitializing">Initializing...</p>
  </div>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="logo"><i class="fas fa-seedling"></i> <span data-i18n="appName">AgriTrade Africa</span></div>

    <div class="nav-center">
      <button class="nav-btn active" onclick="showSection('dashboard', event)"><i class="fas fa-home"></i> <span data-i18n="navDashboard">Dashboard</span></button>
      <button class="nav-btn" onclick="showSection('market', event)"><i class="fas fa-store"></i> <span data-i18n="navMarket">Market</span></button>
      <button class="nav-btn" onclick="showSection('wallet', event)"><i class="fas fa-wallet"></i> <span data-i18n="navWallet">Wallet</span></button>
      <button class="nav-btn" onclick="showSection('ai', event)"><i class="fas fa-robot"></i> <span data-i18n="navAiTools">AI Tools</span></button>
    </div>

    <div class="nav-right">
      <div class="top-date" id="todayDate"></div>

      <select id="language" onchange="setLanguage(this.value)">
        <option value="en">EN</option>
        <option value="es">ES</option>
        <option value="fr">FR</option>
        <option value="ar">AR</option>
      </select>

      <select id="currency" onchange="changeCurrency()">
        <option value="USD">üíµ USD</option>
        <option value="KES">üá∞üá™ KES</option>
        <option value="ETB">üá™üáπ ETB</option>
        <option value="RWF">üá∑üáº RWF</option>
      </select>

      <button class="nav-btn" onclick="toggleVoice()"><i class="fas fa-microphone"></i></button>
      <button class="nav-btn" onclick="showNotifications()"><i class="fas fa-bell"></i></button>
    </div>
  </nav>

  <!-- Main App -->
  <div class="app">
    <!-- Left Sidebar -->
    <aside class="sidebar-left">
      <div class="user-card">
        <div class="avatar">üë®‚Äçüåæ</div>
        <div class="user-name">John Kamau</div>
        <div class="user-level"><span data-i18n="level">Level</span> 12 ‚Ä¢ <span id="xpValue">2,450</span> <span data-i18n="xp">XP</span></div>
        <div class="xp-bar"><div class="xp-fill"></div></div>
      </div>

      <ul class="menu">
        <li class="menu-item"><a class="menu-link active" onclick="showSection('dashboard', event)"><span class="menu-icon"><i class="fas fa-chart-line"></i></span> <span data-i18n="menuDashboard">Dashboard</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="showSection('listings', event)"><span class="menu-icon"><i class="fas fa-warehouse"></i></span> <span data-i18n="menuMyListings">My Listings</span> <span class="badge">3</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="showSection('orders', event)"><span class="menu-icon"><i class="fas fa-box"></i></span> <span data-i18n="menuOrders">Orders</span> <span class="badge">5</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="showSection('logistics', event)"><span class="menu-icon"><i class="fas fa-truck"></i></span> <span data-i18n="menuLogistics">Logistics</span></a></li>
      </ul>

      <div class="section-title" data-i18n="sectionAiAutomation">AI & Automation</div>
      <ul class="menu">
        <li class="menu-item"><a class="menu-link" onclick="openDiseaseScanner()"><span class="menu-icon"><i class="fas fa-camera"></i></span> <span data-i18n="menuDiseaseScanner">Disease Scanner</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="openPricePredictor()"><span class="menu-icon"><i class="fas fa-brain"></i></span> <span data-i18n="menuPriceAi">Price AI</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="openSoilAnalysis()"><span class="menu-icon"><i class="fas fa-flask"></i></span> <span data-i18n="menuSoilAnalysis">Soil Analysis</span></a></li>
      </ul>

      <div class="section-title" data-i18n="sectionBlockchain">Blockchain</div>
      <ul class="menu">
        <li class="menu-item"><a class="menu-link" onclick="showSection('traceability', event)"><span class="menu-icon"><i class="fas fa-link"></i></span> <span data-i18n="menuTraceability">Traceability</span></a></li>
        <li class="menu-item"><a class="menu-link" onclick="showSection('contracts', event)"><span class="menu-icon"><i class="fas fa-file-contract"></i></span> <span data-i18n="menuSmartContracts">Smart Contracts</span></a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="main" id="mainContent">
      <!-- AI Command Center -->
      <div class="ai-banner">
        <div class="ai-header">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-robot" style="font-size: 1.5rem;"></i>
            <div>
              <div style="font-weight: bold;" data-i18n="aiCommandCenter">AI Command Center</div>
              <div style="font-size: 0.875rem; opacity: 0.9;" data-i18n="aiAccuracy">Predictions accurate 94% of the time</div>
            </div>
          </div>
          <div class="ai-status"><div class="pulse"></div> <span data-i18n="live">Live</span></div>
        </div>

        <div class="ai-grid">
          <div class="ai-stat"><div class="ai-value">+12%</div><div class="ai-label" data-i18n="cropCoffee">Coffee</div></div>
          <div class="ai-stat"><div class="ai-value">-5%</div><div class="ai-label" data-i18n="cropMaize">Maize</div></div>
          <div class="ai-stat"><div class="ai-value">86%</div><div class="ai-label" data-i18n="yield">Yield</div></div>
          <div class="ai-stat"><div class="ai-value">3d</div><div class="ai-label" data-i18n="harvest">Harvest</div></div>
        </div>

        <div class="ai-tools">
          <button class="ai-btn" onclick="openDiseaseScanner()"><i class="fas fa-camera"></i> <span data-i18n="scanCrop">Scan Crop</span></button>
          <button class="ai-btn" onclick="openPricePredictor()"><i class="fas fa-chart-line"></i> <span data-i18n="predictPrices">Predict Prices</span></button>
          <button class="ai-btn" onclick="openSoilAnalysis()"><i class="fas fa-flask"></i> <span data-i18n="soilTest">Soil Test</span></button>
          <button class="ai-btn" onclick="openWeatherAI()"><i class="fas fa-cloud-sun"></i> <span data-i18n="weatherAi">Weather AI</span></button>
        </div>
      </div>

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-box">
          <div class="stat-header">
            <span class="stat-title" data-i18n="totalRevenue">Total Revenue</span>
            <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
          </div>
          <div class="stat-value" id="revenue"></div>
          <div class="stat-change"><i class="fas fa-arrow-up"></i> <span id="revChange"></span></div>
        </div>

        <div class="stat-box">
          <div class="stat-header">
            <span class="stat-title" data-i18n="walletBalance">Wallet Balance</span>
            <div class="stat-icon" style="background: #e3f2fd; color: var(--blue);"><i class="fas fa-wallet"></i></div>
          </div>
          <div class="stat-value" id="wallet"></div>
          <div class="stat-change"><i class="fas fa-arrow-up"></i> <span id="walletChange"></span></div>
        </div>

        <div class="stat-box">
          <div class="stat-header">
            <span class="stat-title" data-i18n="activeContracts">Active Contracts</span>
            <div class="stat-icon" style="background: #f3e5f5; color: var(--purple);"><i class="fas fa-file-contract"></i></div>
          </div>
          <div class="stat-value" id="contractsCount">7</div>
          <div class="stat-change"><span data-i18n="pending">2 pending</span></div>
        </div>

        <div class="stat-box">
          <div class="stat-header">
            <span class="stat-title" data-i18n="trustScore">Trust Score</span>
            <div class="stat-icon" style="background: #fff3e0; color: #ff9800;"><i class="fas fa-star"></i></div>
          </div>
          <div class="stat-value" id="trustScoreValue">98%</div>
          <div class="stat-change"><span data-i18n="verified">Verified</span></div>
        </div>
      </div>

      <!-- Features -->
      <div class="feature-grid">
        <div class="feature-card" onclick="openMobileMoney()">
          <div class="feature-header">
            <div class="feature-icon" style="background: linear-gradient(135deg, #4caf50, #8bc34a);"><i class="fas fa-mobile-alt"></i></div>
            <div>
              <div class="feature-title" data-i18n="mobileMoney">Mobile Money</div>
              <div style="font-size: 0.75rem; color: var(--text-light);" data-i18n="mobileMoneyProviders">M-Pesa, MTN, Airtel</div>
            </div>
          </div>
          <div class="feature-desc" data-i18n="mobileMoneyDesc">Send and receive payments instantly via mobile money</div>
          <div class="feature-actions">
            <button class="btn btn-primary"><span data-i18n="send">Send</span></button>
            <button class="btn btn-secondary"><span data-i18n="receive">Receive</span></button>
          </div>
        </div>

        <div class="feature-card" onclick="openSmartContracts()">
          <div class="feature-header">
            <div class="feature-icon" style="background: linear-gradient(135deg, var(--blue), #03a9f4);"><i class="fas fa-file-contract"></i></div>
            <div>
              <div class="feature-title" data-i18n="smartContracts">Smart Contracts</div>
              <div style="font-size: 0.75rem; color: var(--text-light);" data-i18n="smartContractsSub">Auto-execute on delivery</div>
            </div>
          </div>
          <div class="feature-desc" data-i18n="smartContractsDesc">Blockchain-powered contracts with automatic payment release</div>
          <div class="feature-actions">
            <button class="btn btn-primary"><span data-i18n="create">Create</span></button>
            <button class="btn btn-secondary"><span data-i18n="view">View</span></button>
          </div>
        </div>

        <div class="feature-card" onclick="openCooperative()">
          <div class="feature-header">
            <div class="feature-icon" style="background: linear-gradient(135deg, var(--purple), #e91e63);"><i class="fas fa-handshake"></i></div>
            <div>
              <div class="feature-title" data-i18n="cooperative">Cooperative</div>
              <div style="font-size: 0.75rem; color: var(--text-light);" data-i18n="cooperativeSub">142 members</div>
            </div>
          </div>
          <div class="feature-desc" data-i18n="cooperativeDesc">Join forces with other farmers for better prices</div>
          <div class="feature-actions">
            <button class="btn btn-primary"><span data-i18n="chat">Chat</span></button>
            <button class="btn btn-secondary"><span data-i18n="pool">Pool</span></button>
          </div>
        </div>

        <div class="feature-card" onclick="openInsurance()">
          <div class="feature-header">
            <div class="feature-icon" style="background: linear-gradient(135deg, #ff9800, #f57c00);"><i class="fas fa-shield-alt"></i></div>
            <div>
              <div class="feature-title" data-i18n="cropInsurance">Crop Insurance</div>
              <div style="font-size: 0.75rem; color: var(--text-light);" data-i18n="cropInsuranceSub">Weather-indexed</div>
            </div>
          </div>
          <div class="feature-desc" data-i18n="cropInsuranceDesc">Protect your crops against weather and pests</div>
          <div class="feature-actions">
            <button class="btn btn-primary"><span data-i18n="quote">Quote</span></button>
            <button class="btn btn-secondary"><span data-i18n="claim">Claim</span></button>
          </div>
        </div>
      </div>

      <!-- Disease Scanner -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-camera"></i> <span data-i18n="aiDiseaseDetection">AI Disease Detection</span></div>
          <button class="btn btn-secondary" style="width: auto;"><span data-i18n="history">History</span></button>
        </div>

        <div class="scanner" onclick="triggerScan()">
          <div class="scanner-icon"><i class="fas fa-cloud-upload-alt"></i></div>
          <div style="color: var(--text-light); margin-bottom: 0.5rem;" data-i18n="tapUploadCropPhoto">Tap to upload crop photo</div>
          <button class="btn btn-primary" style="width: auto;"><span data-i18n="chooseFile">Choose File</span></button>
        </div>

        <div class="scan-result" id="scanResult">
          <div style="display: flex; align-items: center; gap: 0.75rem;">
            <i class="fas fa-check-circle" style="font-size: 1.5rem; color: #4caf50;"></i>
            <div>
              <div style="font-weight: bold;" data-i18n="healthyCropDetected">Healthy Crop Detected</div>
              <div style="font-size: 0.875rem; color: var(--text-light);"><span data-i18n="confidence">Confidence</span>: 94%</div>
            </div>
          </div>
          <div style="margin-top: 0.75rem; padding: 0.75rem; background: white; border-radius: 8px;">
            <div style="font-size: 0.875rem;" data-i18n="scanAdvice">Your maize crop shows no signs of disease. Continue current care schedule.</div>
          </div>
        </div>
      </div>

      <!-- Logistics Map -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-map-marked-alt"></i> <span data-i18n="liveLogistics">Live Logistics</span></div>
          <div>
            <button class="btn btn-secondary" style="width: auto;"><span data-i18n="all">All</span></button>
            <button class="btn btn-secondary" style="width: auto;"><span data-i18n="inTransit">In Transit</span></button>
          </div>
        </div>
        <div id="map"></div>
      </div>
    </main>

    <!-- Right Sidebar -->
    <aside class="sidebar-right">
      <!-- Wallet -->
      <div class="wallet">
        <div class="wallet-header">
          <span class="wallet-label" data-i18n="digitalWallet">Digital Wallet</span>
          <i class="fas fa-ellipsis-h" style="cursor: pointer;"></i>
        </div>

        <div class="wallet-balance" id="walletBalance"></div>
        <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 1rem;" data-i18n="availableBalance">Available Balance</div>

        <div class="wallet-actions">
          <button class="wallet-btn" onclick="openDeposit()"><i class="fas fa-plus"></i> <span data-i18n="deposit">Deposit</span></button>
          <button class="wallet-btn" onclick="openSend()"><i class="fas fa-paper-plane"></i> <span data-i18n="send">Send</span></button>
          <button class="wallet-btn" onclick="openQR()"><i class="fas fa-qrcode"></i> <span data-i18n="scan">Scan</span></button>
        </div>
      </div>

      <!-- Mobile Money Quick -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-mobile-alt"></i> <span data-i18n="quickPay">Quick Pay</span></div>
        </div>

        <div class="mm-options">
          <div class="mm-option active" onclick="selectMM(this)" data-mm="mpesa">
            <i class="fas fa-mobile-alt" style="font-size: 1.25rem; color: #4caf50;"></i>
            <div style="font-size: 0.75rem; margin-top: 0.25rem;">M-Pesa</div>
          </div>
          <div class="mm-option" onclick="selectMM(this)" data-mm="mtn">
            <i class="fas fa-mobile-alt" style="font-size: 1.25rem; color: var(--blue);"></i>
            <div style="font-size: 0.75rem; margin-top: 0.25rem;">MTN</div>
          </div>
          <div class="mm-option" onclick="selectMM(this)" data-mm="airtel">
            <i class="fas fa-mobile-alt" style="font-size: 1.25rem; color: var(--red);"></i>
            <div style="font-size: 0.75rem; margin-top: 0.25rem;">Airtel</div>
          </div>
        </div>

        <div class="mm-form">
          <input type="tel" class="input" id="mmPhone" data-i18n-placeholder="phoneNumber" placeholder="Phone Number">
          <input type="number" class="input" id="mmAmount" data-i18n-placeholder="amount" placeholder="Amount">
          <button class="btn btn-primary" onclick="sendMobileMoney()"><span data-i18n="sendMoney">Send Money</span></button>
        </div>
      </div>

      <!-- Chat -->
      <div class="chat">
        <div class="chat-header">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-comments"></i>
            <span data-i18n="messages">Messages</span>
          </div>
          <div style="font-size: 0.75rem; opacity: 0.9;"><span id="onlineCount">142</span> <span data-i18n="online">online</span></div>
        </div>

        <div class="chat-tabs">
          <div class="chat-tab active" onclick="switchChat('buyers', event)" data-i18n="buyers">Buyers</div>
          <div class="chat-tab" onclick="switchChat('sellers', event)" data-i18n="sellers">Sellers</div>
          <div class="chat-tab" onclick="switchChat('ai', event)" data-i18n="ai">AI</div>
        </div>

        <div class="chat-messages" id="chatMessages">
          <div class="message">
            <div class="msg-avatar" style="background: var(--primary); color: white;">SM</div>
            <div class="msg-bubble other">
              <div style="font-size: 0.7rem; font-weight: bold; color: var(--text-light); margin-bottom: 0.25rem;">Sarah M.</div>
              <span data-i18n="sampleBuyerMessage">Looking for 500kg maize. Anyone selling?</span>
            </div>
          </div>

          <div class="message own">
            <div class="msg-avatar" style="background: var(--accent); color: var(--text);">ME</div>
            <div class="msg-bubble own"><span data-i18n="sampleOwnMessage">I have Grade A available in Nairobi at $0.45/kg</span></div>
          </div>

          <div class="message">
            <div class="msg-avatar" style="background: linear-gradient(135deg, var(--purple), #e91e63); color: white;">AI</div>
            <div class="msg-bubble ai">
              <div style="font-size: 0.7rem; font-weight: bold; margin-bottom: 0.25rem;">AgriAI</div>
              <span data-i18n="sampleAiTip">üí° Tip: Offer bulk discount for 1000kg+ to increase deal size</span>
            </div>
          </div>
        </div>

        <div class="chat-input">
          <input type="text" id="chatInput" data-i18n-placeholder="typeMessage" placeholder="Type message..." onkeypress="handleChat(event)">
          <button onclick="sendChat()"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>

      <!-- Gamification -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-trophy"></i> <span data-i18n="achievements">Achievements</span></div>
          <span style="font-size: 0.875rem; color: var(--text-light);"><span data-i18n="level">Level</span> 12</span>
        </div>

        <div class="badges" id="badges">
          <div class="badge-item" data-badge="trader" title="Master Trader">
            <div class="badge-icon">üèÜ</div>
            <div class="badge-name" data-i18n="badgeTrader">Trader</div>
          </div>
          <div class="badge-item" data-badge="quality" title="Quality Expert">
            <div class="badge-icon">‚≠ê</div>
            <div class="badge-name" data-i18n="badgeQuality">Quality</div>
          </div>
          <div class="badge-item" data-badge="pioneer" title="Early Adopter">
            <div class="badge-icon">üöÄ</div>
            <div class="badge-name" data-i18n="badgePioneer">Pioneer</div>
          </div>
          <div class="badge-item locked" data-badge="export" title="Locked">
            <div class="badge-icon">üîí</div>
            <div class="badge-name" data-i18n="badgeExport">Export</div>
          </div>
          <div class="badge-item" data-badge="green" title="Sustainable">
            <div class="badge-icon">üå±</div>
            <div class="badge-name" data-i18n="badgeGreen">Green</div>
          </div>
          <div class="badge-item" data-badge="digital" title="Tech Savvy">
            <div class="badge-icon">üíª</div>
            <div class="badge-name" data-i18n="badgeDigital">Digital</div>
          </div>
          <div class="badge-item locked" data-badge="mentor" title="Locked">
            <div class="badge-icon">üîí</div>
            <div class="badge-name" data-i18n="badgeMentor">Mentor</div>
          </div>
          <div class="badge-item" data-badge="leader" title="Community Leader">
            <div class="badge-icon">üë•</div>
            <div class="badge-name" data-i18n="badgeLeader">Leader</div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- Floating Action Button -->
  <button class="fab" onclick="toggleFab()" id="fab" aria-label="fab"><i class="fas fa-plus"></i></button>
  <div class="fab-menu" id="fabMenu">
    <div class="fab-item">
      <button class="fab-small" style="background: var(--primary);" onclick="openNewListing()"><i class="fas fa-plus"></i></button>
      <span class="fab-label" data-i18n="newListing">New Listing</span>
    </div>
    <div class="fab-item">
      <button class="fab-small" style="background: var(--blue);" onclick="openScan()"><i class="fas fa-camera"></i></button>
      <span class="fab-label" data-i18n="scanCrop">Scan Crop</span>
    </div>
    <div class="fab-item">
      <button class="fab-small" style="background: var(--purple);" onclick="openChat()"><i class="fas fa-comment"></i></button>
      <span class="fab-label" data-i18n="quickChat">Quick Chat</span>
    </div>
  </div>

  <!-- Video Call Button -->
  <button style="position: fixed; bottom: 160px; right: 20px; width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, var(--purple), #e91e63); color: white; border: none; cursor: pointer; z-index: 98; box-shadow: var(--shadow-lg);" onclick="startVideoCall()" aria-label="video-call">
    <i class="fas fa-video"></i>
  </button>

  <!-- Voice Overlay -->
  <div class="voice-overlay" id="voiceOverlay" onclick="stopVoice()">
    <div class="voice-circle"><i class="fas fa-microphone"></i></div>
    <div style="font-size: 1.25rem; margin-bottom: 0.5rem;" data-i18n="listening">Listening...</div>
    <div style="opacity: 0.7;" data-i18n="voiceHint">Try: "Show my wallet" or "Scan for diseases"</div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Modal: Mobile Money -->
  <div class="modal" id="mmModal">
    <div class="modal-content">
      <div class="modal-header">
        <div style="display: flex; align-items: center; gap: 0.5rem;"><i class="fas fa-mobile-alt"></i> <span data-i18n="mobileMoney">Mobile Money</span></div>
        <button class="modal-close" onclick="closeModal('mmModal')">&times;</button>
      </div>
      <div class="modal-body">
        <div class="mm-options">
          <div class="mm-option active" onclick="selectMM(this)" data-mm="mpesa">
            <i class="fas fa-mobile-alt" style="font-size: 1.5rem; color: #4caf50;"></i>
            <div style="font-weight: bold; margin-top: 0.25rem;">M-Pesa</div>
          </div>
          <div class="mm-option" onclick="selectMM(this)" data-mm="mtn">
            <i class="fas fa-mobile-alt" style="font-size: 1.5rem; color: var(--blue);"></i>
            <div style="font-weight: bold; margin-top: 0.25rem;">MTN</div>
          </div>
          <div class="mm-option" onclick="selectMM(this)" data-mm="airtel">
            <i class="fas fa-mobile-alt" style="font-size: 1.5rem; color: var(--red);"></i>
            <div style="font-weight: bold; margin-top: 0.25rem;">Airtel</div>
          </div>
        </div>

        <div class="mm-form">
          <label style="font-size: 0.875rem; font-weight: 600;" data-i18n="phoneNumber">Phone Number</label>
          <input type="tel" class="input" data-i18n-placeholder="phonePlaceholder" placeholder="+254 7XX XXX XXX">

          <label style="font-size: 0.875rem; font-weight: 600;" data-i18n="amount">Amount</label>
          <input type="number" class="input" data-i18n-placeholder="amountPlaceholder" placeholder="0.00">

          <button class="btn btn-primary" style="margin-top: 0.5rem;" onclick="processPayment()"><span data-i18n="sendMoney">Send Money</span></button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Disease Scanner -->
  <div class="modal" id="scannerModal">
    <div class="modal-content">
      <div class="modal-header">
        <div style="display: flex; align-items: center; gap: 0.5rem;"><i class="fas fa-camera"></i> <span data-i18n="aiDiseaseScanner">AI Disease Scanner</span></div>
        <button class="modal-close" onclick="closeModal('scannerModal')">&times;</button>
      </div>

      <div class="modal-body">
        <div class="scanner" style="padding: 3rem;" onclick="simulateScan()">
          <div class="scanner-icon"><i class="fas fa-camera" style="font-size: 3rem;"></i></div>
          <div style="margin: 1rem 0;" data-i18n="tapCaptureOrUpload">Tap to capture or upload photo</div>
          <button class="btn btn-primary"><span data-i18n="takePhoto">Take Photo</span></button>
        </div>

        <div id="scanProgress" style="display: none; margin-top: 1rem;">
          <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
            <i class="fas fa-spinner fa-spin"></i>
            <span data-i18n="analyzingWithAi">Analyzing image with AI...</span>
          </div>
          <div style="height: 4px; background: #e0e0e0; border-radius: 2px; overflow: hidden;">
            <div style="height: 100%; width: 0%; background: var(--primary); transition: width 2s;" id="progressBar"></div>
          </div>
        </div>

        <div id="scanResultModal" style="display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9; border-radius: 8px; border-left: 4px solid #4caf50;">
          <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem;">
            <i class="fas fa-check-circle" style="font-size: 1.5rem; color: #4caf50;"></i>
            <div>
              <div style="font-weight: bold;" data-i18n="analysisComplete">Analysis Complete</div>
              <div style="font-size: 0.875rem; color: var(--text-light);"><span data-i18n="confidence">Confidence</span>: 94%</div>
            </div>
          </div>
          <div style="background: white; padding: 0.75rem; border-radius: 6px; margin-top: 0.5rem;">
            <div style="color: #4caf50; font-weight: 600;" data-i18n="noDiseaseDetected">‚úì No disease detected</div>
            <div style="font-size: 0.875rem; margin-top: 0.25rem;" data-i18n="cropHealthyAdvice">Your crop appears healthy. Continue regular care.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /************************************************************
     * PRODUCTION-READY I18N + LOCALE ENGINE (Investor Demo)
     ************************************************************/
    const I18N = {
      en: {
        appName: "AgriTrade Africa",
        loadingExperience: "Loading Ultimate Experience...",
        loaderInitializing: "Initializing...",
        navDashboard: "Dashboard",
        navMarket: "Market",
        navWallet: "Wallet",
        navAiTools: "AI Tools",
        level: "Level",
        xp: "XP",
        menuDashboard: "Dashboard",
        menuMyListings: "My Listings",
        menuOrders: "Orders",
        menuLogistics: "Logistics",
        sectionAiAutomation: "AI & Automation",
        menuDiseaseScanner: "Disease Scanner",
        menuPriceAi: "Price AI",
        menuSoilAnalysis: "Soil Analysis",
        sectionBlockchain: "Blockchain",
        menuTraceability: "Traceability",
        menuSmartContracts: "Smart Contracts",
        aiCommandCenter: "AI Command Center",
        aiAccuracy: "Predictions accurate 94% of the time",
        live: "Live",
        cropCoffee: "Coffee",
        cropMaize: "Maize",
        yield: "Yield",
        harvest: "Harvest",
        scanCrop: "Scan Crop",
        predictPrices: "Predict Prices",
        soilTest: "Soil Test",
        weatherAi: "Weather AI",
        totalRevenue: "Total Revenue",
        walletBalance: "Wallet Balance",
        activeContracts: "Active Contracts",
        pending: "2 pending",
        trustScore: "Trust Score",
        verified: "Verified",
        mobileMoney: "Mobile Money",
        mobileMoneyProviders: "M-Pesa, MTN, Airtel",
        mobileMoneyDesc: "Send and receive payments instantly via mobile money",
        send: "Send",
        receive: "Receive",
        smartContracts: "Smart Contracts",
        smartContractsSub: "Auto-execute on delivery",
        smartContractsDesc: "Blockchain-powered contracts with automatic payment release",
        create: "Create",
        view: "View",
        cooperative: "Cooperative",
        cooperativeSub: "142 members",
        cooperativeDesc: "Join forces with other farmers for better prices",
        chat: "Chat",
        pool: "Pool",
        cropInsurance: "Crop Insurance",
        cropInsuranceSub: "Weather-indexed",
        cropInsuranceDesc: "Protect your crops against weather and pests",
        quote: "Quote",
        claim: "Claim",
        aiDiseaseDetection: "AI Disease Detection",
        history: "History",
        tapUploadCropPhoto: "Tap to upload crop photo",
        chooseFile: "Choose File",
        healthyCropDetected: "Healthy Crop Detected",
        confidence: "Confidence",
        scanAdvice: "Your maize crop shows no signs of disease. Continue current care schedule.",
        liveLogistics: "Live Logistics",
        all: "All",
        inTransit: "In Transit",
        digitalWallet: "Digital Wallet",
        availableBalance: "Available Balance",
        deposit: "Deposit",
        scan: "Scan",
        quickPay: "Quick Pay",
        phoneNumber: "Phone Number",
        amount: "Amount",
        sendMoney: "Send Money",
        phonePlaceholder: "+254 7XX XXX XXX",
        amountPlaceholder: "0.00",
        messages: "Messages",
        online: "online",
        buyers: "Buyers",
        sellers: "Sellers",
        ai: "AI",
        sampleBuyerMessage: "Looking for 500kg maize. Anyone selling?",
        sampleOwnMessage: "I have Grade A available in Nairobi at $0.45/kg",
        sampleAiTip: "üí° Tip: Offer bulk discount for 1000kg+ to increase deal size",
        typeMessage: "Type message...",
        achievements: "Achievements",
        badgeTrader: "Trader",
        badgeQuality: "Quality",
        badgePioneer: "Pioneer",
        badgeExport: "Export",
        badgeGreen: "Green",
        badgeDigital: "Digital",
        badgeMentor: "Mentor",
        badgeLeader: "Leader",
        newListing: "New Listing",
        quickChat: "Quick Chat",
        listening: "Listening...",
        voiceHint: 'Try: "Show my wallet" or "Scan for diseases"',
        aiDiseaseScanner: "AI Disease Scanner",
        tapCaptureOrUpload: "Tap to capture or upload photo",
        takePhoto: "Take Photo",
        analyzingWithAi: "Analyzing image with AI...",
        analysisComplete: "Analysis Complete",
        noDiseaseDetected: "‚úì No disease detected",
        cropHealthyAdvice: "Your crop appears healthy. Continue regular care.",
        // Toasts & dynamic strings
        currencyChanged: "Currency changed to {currency}",
        loadingSection: "Loading {section}...",
        notificationsCount: "5 new notifications",
        voiceOpeningWallet: 'Voice: "Opening wallet"',
        fillAllFields: "Please fill all fields",
        sentTo: "Sent {amount} to {phone}",
        aiAnalyzing: "AI analyzing crop health...",
        analysisCompleteToast: "Analysis complete: Healthy crop!",
        smartContractsToast: "Smart Contracts: Create automated agreements",
        cooperativeToast: "Cooperative: 142 members online",
        insuranceToast: "Insurance: Get weather-indexed coverage",
        priceAiToast: "AI: Coffee +12%, Maize -5% predicted",
        soilToast: "Soil Analysis: pH 6.5 optimal for maize",
        weatherToast: "Weather AI: Optimal harvest in 3 days",
        depositToast: "Deposit: Choose payment method",
        qrToast: "QR Scanner: Point camera at code",
        newListingToast: "New Listing: Create product listing",
        chatToast: "Chat: Connecting to support...",
        videoToast: "Video Call: Connecting...",
        badgeUnlockedTitle: "Badge unlocked!",
        badgeUnlockedMsg: "You unlocked: {badge}",
        badgeAlreadyUnlocked: "Badge already unlocked: {badge}",
        aiReply: "Thanks for your message! I'll help you find the best buyers for your crops."
      },

      es: {
        appName: "AgriTrade Africa",
        loadingExperience: "Cargando experiencia definitiva...",
        loaderInitializing: "Iniciando...",
        navDashboard: "Panel",
        navMarket: "Mercado",
        navWallet: "Billetera",
        navAiTools: "Herramientas IA",
        level: "Nivel",
        xp: "XP",
        menuDashboard: "Panel",
        menuMyListings: "Mis publicaciones",
        menuOrders: "Pedidos",
        menuLogistics: "Log√≠stica",
        sectionAiAutomation: "IA y automatizaci√≥n",
        menuDiseaseScanner: "Esc√°ner de enfermedades",
        menuPriceAi: "IA de precios",
        menuSoilAnalysis: "An√°lisis de suelo",
        sectionBlockchain: "Blockchain",
        menuTraceability: "Trazabilidad",
        menuSmartContracts: "Contratos inteligentes",
        aiCommandCenter: "Centro de mando IA",
        aiAccuracy: "Predicciones con 94% de precisi√≥n",
        live: "En vivo",
        cropCoffee: "Caf√©",
        cropMaize: "Ma√≠z",
        yield: "Rendimiento",
        harvest: "Cosecha",
        scanCrop: "Escanear cultivo",
        predictPrices: "Predecir precios",
        soilTest: "Prueba de suelo",
        weatherAi: "IA del clima",
        totalRevenue: "Ingresos totales",
        walletBalance: "Saldo de billetera",
        activeContracts: "Contratos activos",
        pending: "2 pendientes",
        trustScore: "Puntaje de confianza",
        verified: "Verificado",
        mobileMoney: "Dinero m√≥vil",
        mobileMoneyProviders: "M-Pesa, MTN, Airtel",
        mobileMoneyDesc: "Env√≠a y recibe pagos al instante",
        send: "Enviar",
        receive: "Recibir",
        smartContracts: "Contratos inteligentes",
        smartContractsSub: "Auto-ejecuci√≥n al entregar",
        smartContractsDesc: "Contratos con pagos autom√°ticos al entregar",
        create: "Crear",
        view: "Ver",
        cooperative: "Cooperativa",
        cooperativeSub: "142 miembros",
        cooperativeDesc: "√önete para obtener mejores precios",
        chat: "Chat",
        pool: "Agrupar",
        cropInsurance: "Seguro agr√≠cola",
        cropInsuranceSub: "Indexado al clima",
        cropInsuranceDesc: "Protege tus cultivos ante clima y plagas",
        quote: "Cotizar",
        claim: "Reclamar",
        aiDiseaseDetection: "Detecci√≥n IA de enfermedades",
        history: "Historial",
        tapUploadCropPhoto: "Toca para subir una foto del cultivo",
        chooseFile: "Elegir archivo",
        healthyCropDetected: "Cultivo saludable detectado",
        confidence: "Confianza",
        scanAdvice: "Tu ma√≠z no muestra signos de enfermedad. Contin√∫a con el cuidado actual.",
        liveLogistics: "Log√≠stica en vivo",
        all: "Todo",
        inTransit: "En tr√°nsito",
        digitalWallet: "Billetera digital",
        availableBalance: "Saldo disponible",
        deposit: "Depositar",
        scan: "Escanear",
        quickPay: "Pago r√°pido",
        phoneNumber: "N√∫mero de tel√©fono",
        amount: "Monto",
        sendMoney: "Enviar dinero",
        phonePlaceholder: "+254 7XX XXX XXX",
        amountPlaceholder: "0.00",
        messages: "Mensajes",
        online: "en l√≠nea",
        buyers: "Compradores",
        sellers: "Vendedores",
        ai: "IA",
        sampleBuyerMessage: "Busco 500 kg de ma√≠z. ¬øAlguien vende?",
        sampleOwnMessage: "Tengo Grado A en Nairobi a $0.45/kg",
        sampleAiTip: "üí° Consejo: ofrece descuento por 1000 kg+ para aumentar el acuerdo",
        typeMessage: "Escribe un mensaje...",
        achievements: "Logros",
        badgeTrader: "Comerciante",
        badgeQuality: "Calidad",
        badgePioneer: "Pionero",
        badgeExport: "Exportaci√≥n",
        badgeGreen: "Verde",
        badgeDigital: "Digital",
        badgeMentor: "Mentor",
        badgeLeader: "L√≠der",
        newListing: "Nueva publicaci√≥n",
        quickChat: "Chat r√°pido",
        listening: "Escuchando...",
        voiceHint: 'Prueba: "Mostrar billetera" o "Escanear enfermedades"',
        aiDiseaseScanner: "Esc√°ner IA de enfermedades",
        tapCaptureOrUpload: "Toca para capturar o subir foto",
        takePhoto: "Tomar foto",
        analyzingWithAi: "Analizando imagen con IA...",
        analysisComplete: "An√°lisis completo",
        noDiseaseDetected: "‚úì No se detect√≥ enfermedad",
        cropHealthyAdvice: "Tu cultivo parece saludable. Contin√∫a el cuidado regular.",
        currencyChanged: "Moneda cambiada a {currency}",
        loadingSection: "Cargando {section}...",
        notificationsCount: "5 nuevas notificaciones",
        voiceOpeningWallet: 'Voz: "Abriendo billetera"',
        fillAllFields: "Completa todos los campos",
        sentTo: "Enviado {amount} a {phone}",
        aiAnalyzing: "IA analizando salud del cultivo...",
        analysisCompleteToast: "An√°lisis completo: ¬°cultivo saludable!",
        smartContractsToast: "Contratos inteligentes: crea acuerdos autom√°ticos",
        cooperativeToast: "Cooperativa: 142 miembros en l√≠nea",
        insuranceToast: "Seguro: cobertura indexada al clima",
        priceAiToast: "IA: Caf√© +12%, Ma√≠z -5% (predicci√≥n)",
        soilToast: "Suelo: pH 6.5 √≥ptimo para ma√≠z",
        weatherToast: "Clima: cosecha √≥ptima en 3 d√≠as",
        depositToast: "Dep√≥sito: elige m√©todo de pago",
        qrToast: "Esc√°ner QR: apunta a un c√≥digo",
        newListingToast: "Nueva publicaci√≥n: crea un anuncio",
        chatToast: "Chat: conectando a soporte...",
        videoToast: "Videollamada: conectando...",
        badgeUnlockedTitle: "¬°Insignia desbloqueada!",
        badgeUnlockedMsg: "Desbloqueaste: {badge}",
        badgeAlreadyUnlocked: "Ya desbloqueada: {badge}",
        aiReply: "¬°Gracias por tu mensaje! Te ayudar√© a encontrar los mejores compradores."
      },

      fr: {
        appName: "AgriTrade Africa",
        loadingExperience: "Chargement de l‚Äôexp√©rience ultime...",
        loaderInitializing: "Initialisation...",
        navDashboard: "Tableau",
        navMarket: "March√©",
        navWallet: "Portefeuille",
        navAiTools: "Outils IA",
        level: "Niveau",
        xp: "XP",
        menuDashboard: "Tableau",
        menuMyListings: "Mes annonces",
        menuOrders: "Commandes",
        menuLogistics: "Logistique",
        sectionAiAutomation: "IA & automatisation",
        menuDiseaseScanner: "Scanner maladies",
        menuPriceAi: "IA des prix",
        menuSoilAnalysis: "Analyse du sol",
        sectionBlockchain: "Blockchain",
        menuTraceability: "Tra√ßabilit√©",
        menuSmartContracts: "Contrats intelligents",
        aiCommandCenter: "Centre de commande IA",
        aiAccuracy: "Pr√©dictions exactes √† 94%",
        live: "En direct",
        cropCoffee: "Caf√©",
        cropMaize: "Ma√Øs",
        yield: "Rendement",
        harvest: "R√©colte",
        scanCrop: "Scanner culture",
        predictPrices: "Pr√©dire les prix",
        soilTest: "Test du sol",
        weatherAi: "IA m√©t√©o",
        totalRevenue: "Revenu total",
        walletBalance: "Solde du portefeuille",
        activeContracts: "Contrats actifs",
        pending: "2 en attente",
        trustScore: "Score de confiance",
        verified: "V√©rifi√©",
        mobileMoney: "Mobile Money",
        mobileMoneyProviders: "M-Pesa, MTN, Airtel",
        mobileMoneyDesc: "Envoyez et recevez des paiements instantan√©ment",
        send: "Envoyer",
        receive: "Recevoir",
        smartContracts: "Contrats intelligents",
        smartContractsSub: "Auto-ex√©cution √† la livraison",
        smartContractsDesc: "Contrats blockchain avec paiement automatique",
        create: "Cr√©er",
        view: "Voir",
        cooperative: "Coop√©rative",
        cooperativeSub: "142 membres",
        cooperativeDesc: "Regroupez-vous pour de meilleurs prix",
        chat: "Chat",
        pool: "Regrouper",
        cropInsurance: "Assurance r√©colte",
        cropInsuranceSub: "Index√©e m√©t√©o",
        cropInsuranceDesc: "Prot√©gez vos cultures contre m√©t√©o et nuisibles",
        quote: "Devis",
        claim: "R√©clamer",
        aiDiseaseDetection: "D√©tection IA des maladies",
        history: "Historique",
        tapUploadCropPhoto: "Touchez pour envoyer une photo",
        chooseFile: "Choisir fichier",
        healthyCropDetected: "Culture saine d√©tect√©e",
        confidence: "Confiance",
        scanAdvice: "Aucun signe de maladie sur votre ma√Øs. Continuez les soins actuels.",
        liveLogistics: "Logistique en direct",
        all: "Tout",
        inTransit: "En transit",
        digitalWallet: "Portefeuille num√©rique",
        availableBalance: "Solde disponible",
        deposit: "D√©p√¥t",
        scan: "Scanner",
        quickPay: "Paiement rapide",
        phoneNumber: "Num√©ro de t√©l√©phone",
        amount: "Montant",
        sendMoney: "Envoyer de l‚Äôargent",
        phonePlaceholder: "+254 7XX XXX XXX",
        amountPlaceholder: "0.00",
        messages: "Messages",
        online: "en ligne",
        buyers: "Acheteurs",
        sellers: "Vendeurs",
        ai: "IA",
        sampleBuyerMessage: "Je cherche 500 kg de ma√Øs. Quelqu‚Äôun vend ?",
        sampleOwnMessage: "J‚Äôai du Grade A √† Nairobi √† 0,45 $/kg",
        sampleAiTip: "üí° Astuce : proposez une remise d√®s 1000 kg+",
        typeMessage: "√âcrire un message...",
        achievements: "Succ√®s",
        badgeTrader: "Marchand",
        badgeQuality: "Qualit√©",
        badgePioneer: "Pionnier",
        badgeExport: "Export",
        badgeGreen: "Vert",
        badgeDigital: "Num√©rique",
        badgeMentor: "Mentor",
        badgeLeader: "Leader",
        newListing: "Nouvelle annonce",
        quickChat: "Chat rapide",
        listening: "√âcoute...",
        voiceHint: 'Essayez : "Afficher mon portefeuille" ou "Scanner maladies"',
        aiDiseaseScanner: "Scanner IA des maladies",
        tapCaptureOrUpload: "Touchez pour capturer ou envoyer une photo",
        takePhoto: "Prendre une photo",
        analyzingWithAi: "Analyse de l‚Äôimage par IA...",
        analysisComplete: "Analyse termin√©e",
        noDiseaseDetected: "‚úì Aucune maladie d√©tect√©e",
        cropHealthyAdvice: "Votre culture semble saine. Continuez les soins r√©guliers.",
        currencyChanged: "Devise chang√©e : {currency}",
        loadingSection: "Chargement {section}...",
        notificationsCount: "5 nouvelles notifications",
        voiceOpeningWallet: 'Voix : "Ouverture du portefeuille"',
        fillAllFields: "Veuillez remplir tous les champs",
        sentTo: "Envoy√© {amount} √† {phone}",
        aiAnalyzing: "IA analyse la sant√© de la culture...",
        analysisCompleteToast: "Analyse termin√©e : culture saine !",
        smartContractsToast: "Contrats intelligents : cr√©ez des accords automatis√©s",
        cooperativeToast: "Coop√©rative : 142 membres en ligne",
        insuranceToast: "Assurance : couverture index√©e m√©t√©o",
        priceAiToast: "IA : Caf√© +12%, Ma√Øs -5% (pr√©vision)",
        soilToast: "Sol : pH 6,5 optimal pour le ma√Øs",
        weatherToast: "M√©t√©o : r√©colte optimale dans 3 jours",
        depositToast: "D√©p√¥t : choisir un moyen de paiement",
        qrToast: "Scanner QR : pointez vers un code",
        newListingToast: "Nouvelle annonce : cr√©er une offre",
        chatToast: "Chat : connexion au support...",
        videoToast: "Appel vid√©o : connexion...",
        badgeUnlockedTitle: "Badge d√©bloqu√© !",
        badgeUnlockedMsg: "Vous avez d√©bloqu√© : {badge}",
        badgeAlreadyUnlocked: "D√©j√† d√©bloqu√© : {badge}",
        aiReply: "Merci pour votre message ! Je vais vous aider √† trouver les meilleurs acheteurs."
      },

      ar: {
        appName: "ÿ£ÿ¨ÿ±Ÿä ÿ™ÿ±ŸäÿØ ÿ£ŸÅÿ±ŸäŸÇŸäÿß",
        loadingExperience: "ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ™ÿ¨ÿ±ÿ®ÿ© ÿßŸÑŸÉÿßŸÖŸÑÿ©...",
        loaderInitializing: "ÿ¨ÿßÿ±Ÿç ÿßŸÑÿ®ÿØÿ°...",
        navDashboard: "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
        navMarket: "ÿßŸÑÿ≥ŸàŸÇ",
        navWallet: "ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©",
        navAiTools: "ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ°",
        level: "ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ",
        xp: "ŸÜŸÇÿßÿ∑",
        menuDashboard: "ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ",
        menuMyListings: "ÿπÿ±Ÿàÿ∂Ÿä",
        menuOrders: "ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™",
        menuLogistics: "ÿßŸÑŸÑŸàÿ¨ÿ≥ÿ™Ÿäÿßÿ™",
        sectionAiAutomation: "ÿßŸÑÿ∞ŸÉÿßÿ° ŸàÿßŸÑÿ£ÿ™ŸÖÿ™ÿ©",
        menuDiseaseScanner: "ŸÖÿßÿ≥ÿ≠ ÿßŸÑÿ£ŸÖÿ±ÿßÿ∂",
        menuPriceAi: "ÿ∞ŸÉÿßÿ° ÿßŸÑÿ£ÿ≥ÿπÿßÿ±",
        menuSoilAnalysis: "ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿ™ÿ±ÿ®ÿ©",
        sectionBlockchain: "ÿßŸÑÿ®ŸÑŸàŸÉÿ™ÿ¥ŸäŸÜ",
        menuTraceability: "ÿßŸÑÿ™ÿ™ÿ®ÿπ",
        menuSmartContracts: "ÿßŸÑÿπŸÇŸàÿØ ÿßŸÑÿ∞ŸÉŸäÿ©",
        aiCommandCenter: "ŸÖÿ±ŸÉÿ≤ ŸÇŸäÿßÿØÿ© ÿßŸÑÿ∞ŸÉÿßÿ°",
        aiAccuracy: "ÿ™ŸàŸÇÿπÿßÿ™ ÿ®ÿØŸÇÿ© Ÿ©Ÿ§Ÿ™",
        live: "ŸÖÿ®ÿßÿ¥ÿ±",
        cropCoffee: "ÿßŸÑŸÇŸáŸàÿ©",
        cropMaize: "ÿßŸÑÿ∞ÿ±ÿ©",
        yield: "ÿßŸÑÿ•ŸÜÿ™ÿßÿ¨",
        harvest: "ÿßŸÑÿ≠ÿµÿßÿØ",
        scanCrop: "ŸÖÿ≥ÿ≠ ÿßŸÑŸÖÿ≠ÿµŸàŸÑ",
        predictPrices: "ÿ™ŸàŸÇÿπ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±",
        soilTest: "ŸÅÿ≠ÿµ ÿßŸÑÿ™ÿ±ÿ®ÿ©",
        weatherAi: "ÿ∞ŸÉÿßÿ° ÿßŸÑÿ∑ŸÇÿ≥",
        totalRevenue: "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ•Ÿäÿ±ÿßÿØÿßÿ™",
        walletBalance: "ÿ±ÿµŸäÿØ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©",
        activeContracts: "ÿßŸÑÿπŸÇŸàÿØ ÿßŸÑŸÜÿ¥ÿ∑ÿ©",
        pending: "Ÿ¢ ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±",
        trustScore: "ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ´ŸÇÿ©",
        verified: "ŸÖŸàÿ´ŸÇ",
        mobileMoney: "ÿßŸÑŸÖÿßŸÑ ÿπÿ®ÿ± ÿßŸÑŸáÿßÿ™ŸÅ",
        mobileMoneyProviders: "M-Pesa, MTN, Airtel",
        mobileMoneyDesc: "ÿ£ÿ±ÿ≥ŸÑ Ÿàÿßÿ≥ÿ™ŸÑŸÖ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ŸÅŸàÿ±Ÿãÿß ÿπÿ®ÿ± ÿßŸÑŸáÿßÿ™ŸÅ",
        send: "ÿ•ÿ±ÿ≥ÿßŸÑ",
        receive: "ÿßÿ≥ÿ™ŸÑÿßŸÖ",
        smartContracts: "ÿßŸÑÿπŸÇŸàÿØ ÿßŸÑÿ∞ŸÉŸäÿ©",
        smartContractsSub: "ÿ™ŸÜŸÅŸäÿ∞ ÿ™ŸÑŸÇÿßÿ¶Ÿä ÿπŸÜÿØ ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ",
        smartContractsDesc: "ÿπŸÇŸàÿØ ÿ®ŸÑŸàŸÉÿ™ÿ¥ŸäŸÜ ŸÖÿπ ÿ™ÿ≠ÿ±Ÿäÿ± ÿßŸÑÿØŸÅÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäŸãÿß",
        create: "ÿ•ŸÜÿ¥ÿßÿ°",
        view: "ÿπÿ±ÿ∂",
        cooperative: "ÿßŸÑÿ™ÿπÿßŸàŸÜŸäÿ©",
        cooperativeSub: "Ÿ°Ÿ§Ÿ¢ ÿπÿ∂ŸàŸãÿß",
        cooperativeDesc: "ÿ™ÿπÿßŸàŸÜ ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿ£ÿ≥ÿπÿßÿ± ÿ£ŸÅÿ∂ŸÑ",
        chat: "ÿØÿ±ÿØÿ¥ÿ©",
        pool: "ÿ™ÿ¨ŸÖŸäÿπ",
        cropInsurance: "ÿ™ÿ£ŸÖŸäŸÜ ÿßŸÑŸÖÿ≠ÿßÿµŸäŸÑ",
        cropInsuranceSub: "ŸÖÿ±ÿ™ÿ®ÿ∑ ÿ®ÿßŸÑÿ∑ŸÇÿ≥",
        cropInsuranceDesc: "ÿ≠ŸÖÿßŸäÿ© ÿ∂ÿØ ÿßŸÑÿ∑ŸÇÿ≥ ŸàÿßŸÑÿ¢ŸÅÿßÿ™",
        quote: "ÿπÿ±ÿ∂ ÿ≥ÿπÿ±",
        claim: "ŸÖÿ∑ÿßŸÑÿ®ÿ©",
        aiDiseaseDetection: "ŸÉÿ¥ŸÅ ÿßŸÑÿ£ŸÖÿ±ÿßÿ∂ ÿ®ÿßŸÑÿ∞ŸÉÿßÿ°",
        history: "ÿßŸÑÿ≥ÿ¨ŸÑ",
        tapUploadCropPhoto: "ÿßÿ∂ÿ∫ÿ∑ ŸÑÿ±ŸÅÿπ ÿµŸàÿ±ÿ© ŸÑŸÑŸÖÿ≠ÿµŸàŸÑ",
        chooseFile: "ÿßÿÆÿ™ÿ± ŸÖŸÑŸÅŸãÿß",
        healthyCropDetected: "ÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ŸÖÿ≠ÿµŸàŸÑ ÿ≥ŸÑŸäŸÖ",
        confidence: "ÿßŸÑÿ´ŸÇÿ©",
        scanAdvice: "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿπŸÑÿßŸÖÿßÿ™ ŸÖÿ±ÿ∂ ÿπŸÑŸâ ÿßŸÑÿ∞ÿ±ÿ©. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿπŸÜÿßŸäÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©.",
        liveLogistics: "ŸÑŸàÿ¨ÿ≥ÿ™Ÿäÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ©",
        all: "ÿßŸÑŸÉŸÑ",
        inTransit: "ŸÇŸäÿØ ÿßŸÑŸÜŸÇŸÑ",
        digitalWallet: "ŸÖÿ≠ŸÅÿ∏ÿ© ÿ±ŸÇŸÖŸäÿ©",
        availableBalance: "ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑŸÖÿ™ÿßÿ≠",
        deposit: "ÿ•ŸäÿØÿßÿπ",
        scan: "ŸÖÿ≥ÿ≠",
        quickPay: "ÿØŸÅÿπ ÿ≥ÿ±Ÿäÿπ",
        phoneNumber: "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
        amount: "ÿßŸÑŸÖÿ®ŸÑÿ∫",
        sendMoney: "ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÖÿßŸÑ",
        phonePlaceholder: "+254 7XX XXX XXX",
        amountPlaceholder: "0.00",
        messages: "ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ",
        online: "ŸÖÿ™ÿµŸÑ",
        buyers: "ÿßŸÑŸÖÿ¥ÿ™ÿ±ŸàŸÜ",
        sellers: "ÿßŸÑÿ®ÿßÿ¶ÿπŸàŸÜ",
        ai: "ÿßŸÑÿ∞ŸÉÿßÿ°",
        sampleBuyerMessage: "ÿ£ÿ®ÿ≠ÿ´ ÿπŸÜ Ÿ•Ÿ†Ÿ† ŸÉÿ¨ŸÖ ÿ∞ÿ±ÿ©. ŸáŸÑ ŸäŸàÿ¨ÿØ ÿ®ÿßÿ¶ÿπÿü",
        sampleOwnMessage: "ŸÑÿØŸä ÿØÿ±ÿ¨ÿ© A ŸÅŸä ŸÜŸäÿ±Ÿàÿ®Ÿä ÿ®ÿ≥ÿπÿ± 0.45$/ŸÉÿ¨ŸÖ",
        sampleAiTip: "üí° ŸÜÿµŸäÿ≠ÿ©: ŸÇÿØŸÖ ÿÆÿµŸÖŸãÿß ÿπŸÜÿØ 1000 ŸÉÿ¨ŸÖ+ ŸÑÿ≤ŸäÿßÿØÿ© ÿßŸÑÿµŸÅŸÇÿ©",
        typeMessage: "ÿßŸÉÿ™ÿ® ÿ±ÿ≥ÿßŸÑÿ©...",
        achievements: "ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™",
        badgeTrader: "ÿ™ÿßÿ¨ÿ±",
        badgeQuality: "ÿ¨ŸàÿØÿ©",
        badgePioneer: "ÿ±ÿßÿ¶ÿØ",
        badgeExport: "ÿ™ÿµÿØŸäÿ±",
        badgeGreen: "ŸÖÿ≥ÿ™ÿØÿßŸÖ",
        badgeDigital: "ÿ±ŸÇŸÖŸä",
        badgeMentor: "ŸÖÿ±ÿ¥ÿØ",
        badgeLeader: "ŸÇÿßÿ¶ÿØ",
        newListing: "ÿπÿ±ÿ∂ ÿ¨ÿØŸäÿØ",
        quickChat: "ÿØÿ±ÿØÿ¥ÿ© ÿ≥ÿ±Ÿäÿπÿ©",
        listening: "Ÿäÿ≥ÿ™ŸÖÿπ...",
        voiceHint: 'ÿ¨ÿ±Ÿëÿ®: "ÿßÿπÿ±ÿ∂ ŸÖÿ≠ŸÅÿ∏ÿ™Ÿä" ÿ£Ÿà "ÿßŸÖÿ≥ÿ≠ ÿßŸÑÿ£ŸÖÿ±ÿßÿ∂"',
        aiDiseaseScanner: "ŸÖÿßÿ≥ÿ≠ ÿßŸÑÿ£ŸÖÿ±ÿßÿ∂ ÿ®ÿßŸÑÿ∞ŸÉÿßÿ°",
        tapCaptureOrUpload: "ÿßÿ∂ÿ∫ÿ∑ ŸÑÿßŸÑÿ™ŸÇÿßÿ∑ ÿ£Ÿà ÿ±ŸÅÿπ ÿµŸàÿ±ÿ©",
        takePhoto: "ÿßŸÑÿ™ŸÇÿßÿ∑ ÿµŸàÿ±ÿ©",
        analyzingWithAi: "ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿµŸàÿ±ÿ© ÿ®ÿßŸÑÿ∞ŸÉÿßÿ°...",
        analysisComplete: "ÿßŸÉÿ™ŸÖŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ",
        noDiseaseDetected: "‚úì ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿ±ÿ∂",
        cropHealthyAdvice: "ÿßŸÑŸÖÿ≠ÿµŸàŸÑ Ÿäÿ®ÿØŸà ÿ≥ŸÑŸäŸÖŸãÿß. ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿπŸÜÿßŸäÿ© ÿßŸÑŸÖÿπÿ™ÿßÿØÿ©.",
        currencyChanged: "ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿπŸÖŸÑÿ© ÿ•ŸÑŸâ {currency}",
        loadingSection: "ÿ¨ÿßÿ±Ÿç ÿ™ÿ≠ŸÖŸäŸÑ {section}...",
        notificationsCount: "Ÿ• ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿ¨ÿØŸäÿØÿ©",
        voiceOpeningWallet: 'ÿßŸÑÿµŸàÿ™: "ŸÅÿ™ÿ≠ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©"',
        fillAllFields: "Ÿäÿ±ÿ¨Ÿâ ÿ™ÿπÿ®ÿ¶ÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ",
        sentTo: "ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ {amount} ÿ•ŸÑŸâ {phone}",
        aiAnalyzing: "ÿßŸÑÿ∞ŸÉÿßÿ° Ÿäÿ≠ŸÑŸÑ ÿµÿ≠ÿ© ÿßŸÑŸÖÿ≠ÿµŸàŸÑ...",
        analysisCompleteToast: "ÿßŸÉÿ™ŸÖŸÑ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ: ŸÖÿ≠ÿµŸàŸÑ ÿ≥ŸÑŸäŸÖ!",
        smartContractsToast: "ÿßŸÑÿπŸÇŸàÿØ ÿßŸÑÿ∞ŸÉŸäÿ©: ÿ£ŸÜÿ¥ÿ¶ ÿßÿ™ŸÅÿßŸÇŸäÿßÿ™ ÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©",
        cooperativeToast: "ÿßŸÑÿ™ÿπÿßŸàŸÜŸäÿ©: Ÿ°Ÿ§Ÿ¢ ÿπÿ∂ŸàŸãÿß ŸÖÿ™ÿµŸÑŸãÿß",
        insuranceToast: "ÿßŸÑÿ™ÿ£ŸÖŸäŸÜ: ÿ™ÿ∫ÿ∑Ÿäÿ© ŸÖÿ±ÿ™ÿ®ÿ∑ÿ© ÿ®ÿßŸÑÿ∑ŸÇÿ≥",
        priceAiToast: "ÿßŸÑÿ∞ŸÉÿßÿ°: ÿßŸÑŸÇŸáŸàÿ© +12%ÿå ÿßŸÑÿ∞ÿ±ÿ© -5% (ÿ™ŸàŸÇÿπ)",
        soilToast: "ÿßŸÑÿ™ÿ±ÿ®ÿ©: ÿØÿ±ÿ¨ÿ© ÿ≠ŸÖŸàÿ∂ÿ© 6.5 ŸÖÿ´ÿßŸÑŸäÿ© ŸÑŸÑÿ∞ÿ±ÿ©",
        weatherToast: "ÿßŸÑÿ∑ŸÇÿ≥: ÿ£ŸÅÿ∂ŸÑ ÿ≠ÿµÿßÿØ ÿÆŸÑÿßŸÑ 3 ÿ£ŸäÿßŸÖ",
        depositToast: "ÿßŸÑÿ•ŸäÿØÿßÿπ: ÿßÿÆÿ™ÿ± Ÿàÿ≥ŸäŸÑÿ© ÿßŸÑÿØŸÅÿπ",
        qrToast: "ŸÖÿßÿ≥ÿ≠ QR: Ÿàÿ¨ŸëŸá ÿßŸÑŸÉÿßŸÖŸäÿ±ÿß ÿ•ŸÑŸâ ÿßŸÑÿ±ŸÖÿ≤",
        newListingToast: "ÿπÿ±ÿ∂ ÿ¨ÿØŸäÿØ: ÿ•ŸÜÿ¥ÿßÿ° ÿ•ÿπŸÑÿßŸÜ ŸÖŸÜÿ™ÿ¨",
        chatToast: "ÿßŸÑÿØÿ±ÿØÿ¥ÿ©: ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿØÿπŸÖ...",
        videoToast: "ŸÖŸÉÿßŸÑŸÖÿ© ŸÅŸäÿØŸäŸà: ÿ¨ÿßÿ±Ÿç ÿßŸÑÿßÿ™ÿµÿßŸÑ...",
        badgeUnlockedTitle: "ÿ™ŸÖ ŸÅÿ™ÿ≠ ÿ¥ÿßÿ±ÿ©!",
        badgeUnlockedMsg: "ŸÑŸÇÿØ ŸÅÿ™ÿ≠ÿ™: {badge}",
        badgeAlreadyUnlocked: "ÿ™ŸÖ ŸÅÿ™ÿ≠Ÿáÿß ŸÖÿ≥ÿ®ŸÇŸãÿß: {badge}",
        aiReply: "ÿ¥ŸÉÿ±Ÿãÿß ŸÑÿ±ÿ≥ÿßŸÑÿ™ŸÉ! ÿ≥ÿ£ÿ≥ÿßÿπÿØŸÉ ŸÅŸä ÿ•Ÿäÿ¨ÿßÿØ ÿ£ŸÅÿ∂ŸÑ ÿßŸÑŸÖÿ¥ÿ™ÿ±ŸäŸÜ."
      }
    };

    // Locale mapping for number/date formats
    const LOCALES = {
      en: "en-US",
      es: "es-ES",
      fr: "fr-FR",
      ar: "ar"
    };

    // Currency formatting
    const DEFAULT_RATES = { USD: 1, KES: 130.5, ETB: 54.2, RWF: 1220 };
    let rates = { ...DEFAULT_RATES };

    // Demo state (single-file)
    const state = {
      lang: localStorage.getItem("agri_lang") || "en",
      currency: localStorage.getItem("agri_currency") || "USD",
      // base values in USD for demo
      revenueUSD: 24500,
      walletUSD: 8320,
      walletBalanceUSD: 8320.5,
      revChangePct: 0.15,
      walletChangeUSD: 1200,
      unlockedBadges: new Set(JSON.parse(localStorage.getItem("agri_unlocked_badges") || "[]"))
    };

    function safeGet(obj, path, fallback) {
      try {
        return path.split(".").reduce((acc, k) => acc && acc[k], obj) ?? fallback;
      } catch { return fallback; }
    }

    function t(key, params = {}) {
      const langPack = I18N[state.lang] || I18N.en;
      let str = langPack[key] || I18N.en[key] || key;
      for (const [k, v] of Object.entries(params)) {
        str = str.replaceAll(`{${k}}`, String(v));
      }
      return str;
    }

    function formatNumber(value, opts = {}) {
      const locale = LOCALES[state.lang] || "en-US";
      try {
        return new Intl.NumberFormat(locale, opts).format(value);
      } catch {
        return Number(value).toLocaleString();
      }
    }

    function formatCurrency(amount, currency) {
      const locale = LOCALES[state.lang] || "en-US";
      try {
        return new Intl.NumberFormat(locale, { style: "currency", currency }).format(amount);
      } catch {
        // fallback: symbol-lite
        const symbol = currency === "USD" ? "$" : currency + " ";
        return symbol + formatNumber(amount, { maximumFractionDigits: 2 });
      }
    }

    function formatDate(date) {
      const locale = LOCALES[state.lang] || "en-US";
      try {
        return new Intl.DateTimeFormat(locale, { weekday: "short", year: "numeric", month: "short", day: "numeric" }).format(date);
      } catch {
        return date.toDateString();
      }
    }

    function applyI18n() {
      // text nodes
      document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        el.textContent = t(key);
      });

      // placeholders
      document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
        const key = el.getAttribute("data-i18n-placeholder");
        el.setAttribute("placeholder", t(key));
      });

      // update date label
      const dateEl = document.getElementById("todayDate");
      if (dateEl) dateEl.textContent = formatDate(new Date());
    }

    function setLanguage(lang) {
      if (!I18N[lang]) lang = "en";
      state.lang = lang;
      localStorage.setItem("agri_lang", lang);

      document.documentElement.lang = lang;
      document.documentElement.dir = (lang === "ar") ? "rtl" : "ltr";

      // Keep selects synced
      const langSel = document.getElementById("language");
      if (langSel) langSel.value = lang;

      applyI18n();
      // Re-render money/stat formatting after language change
      renderStats();
      showToast(t("loadingSection", { section: t("navDashboard") }), "info");
    }

    function changeCurrency() {
      const sel = document.getElementById("currency");
      state.currency = sel ? sel.value : "USD";
      localStorage.setItem("agri_currency", state.currency);
      renderStats();
      showToast(t("currencyChanged", { currency: state.currency }), "success");
    }

    function renderStats() {
      const rate = rates[state.currency] || 1;

      const rev = state.revenueUSD * rate;
      const wal = state.walletUSD * rate;
      const walBal = state.walletBalanceUSD * rate;

      const revEl = document.getElementById("revenue");
      const walEl = document.getElementById("wallet");
      const walBalEl = document.getElementById("walletBalance");

      if (revEl) revEl.textContent = formatCurrency(rev, state.currency);
      if (walEl) walEl.textContent = formatCurrency(wal, state.currency);
      if (walBalEl) walBalEl.textContent = formatCurrency(walBal, state.currency);

      // Change labels
      const revChangeEl = document.getElementById("revChange");
      if (revChangeEl) {
        const pct = Math.round(state.revChangePct * 100);
        revChangeEl.textContent = "+" + formatNumber(pct) + "%";
      }

      const walletChangeEl = document.getElementById("walletChange");
      if (walletChangeEl) {
        walletChangeEl.textContent = "+" + formatCurrency(state.walletChangeUSD * rate, state.currency);
      }

      // XP localized
      const xp = document.getElementById("xpValue");
      if (xp) xp.textContent = formatNumber(2450);
    }

    /************************************************************
     * UI / Demo Functions (language-aware)
     ************************************************************/
    // Loading Screen
    window.addEventListener("load", () => {
      // set selects early
      const langSel = document.getElementById("language");
      if (langSel) langSel.value = state.lang;
      const curSel = document.getElementById("currency");
      if (curSel) curSel.value = state.currency;

      // localized loader steps
      const loaderSteps = {
        en: ["Initializing AI modules...", "Loading blockchain...", "Connecting to mobile money...", "Setting up secure channels...", "Ready!"],
        es: ["Iniciando m√≥dulos IA...", "Cargando blockchain...", "Conectando dinero m√≥vil...", "Asegurando canales...", "¬°Listo!"],
        fr: ["Initialisation IA...", "Chargement blockchain...", "Connexion mobile money...", "Canaux s√©curis√©s...", "Pr√™t !"],
        ar: ["ÿ™ŸáŸäÿ¶ÿ© Ÿàÿ≠ÿØÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ°...", "ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸÑŸàŸÉÿ™ÿ¥ŸäŸÜ...", "ÿ±ÿ®ÿ∑ ÿßŸÑŸÖÿßŸÑ ÿπÿ®ÿ± ÿßŸÑŸáÿßÿ™ŸÅ...", "ÿ™ÿ£ŸÖŸäŸÜ ÿßŸÑŸÇŸÜŸàÿßÿ™...", "ÿ¨ÿßŸáÿ≤!"]
      };

      let progress = 0;
      const loader = document.getElementById("loader");
      const progressBar = document.getElementById("loaderProgress");
      const loaderText = document.getElementById("loaderText");

      // init i18n + stats before hide
      setLanguage(state.lang);      // calls applyI18n + renderStats
      changeCurrency();             // re-render stats + toast, but loader is visible; ok

      const interval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          setTimeout(() => {
            loader.classList.add("hidden");
            initMap();
            hydrateBadges();
            attachBadgeClicks();
          }, 450);
        }
        if (progressBar) progressBar.style.width = progress + "%";

        const steps = loaderSteps[state.lang] || loaderSteps.en;
        const idx = Math.min(steps.length - 1, Math.floor((progress / 100) * (steps.length - 1)));
        if (loaderText) loaderText.textContent = steps[idx];
      }, 200);
    });

    // Initialize Map (demo)
    function initMap() {
      const mapEl = document.getElementById("map");
      if (!mapEl) return;

      const map = L.map("map").setView([-1.2921, 36.8219], 6);
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

      // localized marker labels
      const markers = [
        { pos: [-1.2921, 36.8219], titleKey: "markerWarehouse" },
        { pos: [-0.0236, 37.9062], titleKey: "markerFarm" },
        { pos: [-1.2864, 36.8172], titleKey: "markerTransit" }
      ];

      const markerText = {
        en: { markerWarehouse: "Nairobi - Warehouse", markerFarm: "Mt. Kenya - Farm", markerTransit: "In Transit" },
        es: { markerWarehouse: "Nairobi - Almac√©n", markerFarm: "Monte Kenia - Granja", markerTransit: "En tr√°nsito" },
        fr: { markerWarehouse: "Nairobi - Entrep√¥t", markerFarm: "Mont Kenya - Ferme", markerTransit: "En transit" },
        ar: { markerWarehouse: "ŸÜŸäÿ±Ÿàÿ®Ÿä - ŸÖÿ≥ÿ™ŸàÿØÿπ", markerFarm: "ÿ¨ÿ®ŸÑ ŸÉŸäŸÜŸäÿß - ŸÖÿ≤ÿ±ÿπÿ©", markerTransit: "ŸÇŸäÿØ ÿßŸÑŸÜŸÇŸÑ" }
      };

      const pack = markerText[state.lang] || markerText.en;
      markers.forEach(m => L.marker(m.pos).addTo(map).bindPopup(pack[m.titleKey]));
    }

    // Navigation
    function showSection(section, evt) {
      document.querySelectorAll(".menu-link").forEach(l => l.classList.remove("active"));
      if (evt && evt.target) {
        const link = evt.target.closest(".menu-link");
        if (link) link.classList.add("active");
      }
      // localized section label (simple mapping)
      const sectionNames = {
        dashboard: t("navDashboard"),
        market: t("navMarket"),
        wallet: t("navWallet"),
        ai: t("navAiTools"),
        listings: t("menuMyListings"),
        orders: t("menuOrders"),
        logistics: t("menuLogistics"),
        traceability: t("menuTraceability"),
        contracts: t("menuSmartContracts")
      };
      showToast(t("loadingSection", { section: sectionNames[section] || section }), "success");
    }

    // Notifications
    function showNotifications() {
      showToast(t("notificationsCount"), "info");
    }

    // Voice
    function toggleVoice() {
      document.getElementById("voiceOverlay").classList.add("active");
      setTimeout(() => {
        showToast(t("voiceOpeningWallet"), "success");
        stopVoice();
      }, 2200);
    }
    function stopVoice() {
      document.getElementById("voiceOverlay").classList.remove("active");
    }

    // FAB
    function toggleFab() {
      const menu = document.getElementById("fabMenu");
      const fab = document.getElementById("fab");
      menu.classList.toggle("active");
      fab.style.transform = menu.classList.contains("active") ? "rotate(45deg)" : "rotate(0)";
    }

    // Chat
    function switchChat(tab, evt) {
      document.querySelectorAll(".chat-tab").forEach(tEl => tEl.classList.remove("active"));
      if (evt && evt.target) evt.target.classList.add("active");
    }
    function handleChat(e) { if (e.key === "Enter") sendChat(); }

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function sendChat() {
      const input = document.getElementById("chatInput");
      if (!input.value.trim()) return;

      const messages = document.getElementById("chatMessages");
      const userMsg = escapeHtml(input.value.trim());

      messages.innerHTML += `
        <div class="message own">
          <div class="msg-avatar" style="background: var(--accent); color: var(--text);">ME</div>
          <div class="msg-bubble own">${userMsg}</div>
        </div>
      `;

      input.value = "";
      messages.scrollTop = messages.scrollHeight;

      // AI Response (language-aware canned)
      setTimeout(() => {
        messages.innerHTML += `
          <div class="message">
            <div class="msg-avatar" style="background: linear-gradient(135deg, var(--purple), #e91e63); color: white;">AI</div>
            <div class="msg-bubble ai">
              <div style="font-size: 0.7rem; font-weight: bold; margin-bottom: 0.25rem;">AgriAI</div>
              ${escapeHtml(t("aiReply"))}
            </div>
          </div>
        `;
        messages.scrollTop = messages.scrollHeight;
      }, 900);
    }

    // Mobile Money
    function selectMM(el) {
      document.querySelectorAll(".mm-option").forEach(o => o.classList.remove("active"));
      el.classList.add("active");
    }

    function sendMobileMoney() {
      const phone = document.getElementById("mmPhone").value.trim();
      const amount = document.getElementById("mmAmount").value.trim();
      if (!phone || !amount) {
        showToast(t("fillAllFields"), "error");
        return;
      }

      // amount localized (as a number) for toast
      const amtNum = Number(amount);
      const amtTxt = Number.isFinite(amtNum) ? formatCurrency(amtNum, state.currency) : amount;

      showToast(t("sentTo", { amount: amtTxt, phone }), "success");

      document.getElementById("mmPhone").value = "";
      document.getElementById("mmAmount").value = "";
    }

    // Scanner
    function triggerScan() {
      document.getElementById("scanResult").style.display = "block";
      showToast(t("aiAnalyzing"), "success");
    }

    function simulateScan() {
      document.getElementById("scanProgress").style.display = "block";
      document.getElementById("progressBar").style.width = "100%";

      setTimeout(() => {
        document.getElementById("scanProgress").style.display = "none";
        document.getElementById("scanResultModal").style.display = "block";
        showToast(t("analysisCompleteToast"), "success");
      }, 1600);
    }

    // Modals
    function openMobileMoney() { document.getElementById("mmModal").classList.add("active"); }
    function openDiseaseScanner() { document.getElementById("scannerModal").classList.add("active"); }
    function closeModal(id) { document.getElementById(id).classList.remove("active"); }

    // Feature buttons (localized)
    function openSmartContracts() { showToast(t("smartContractsToast"), "success"); }
    function openCooperative() { showToast(t("cooperativeToast"), "success"); }
    function openInsurance() { showToast(t("insuranceToast"), "success"); }
    function openPricePredictor() { showToast(t("priceAiToast"), "success"); }
    function openSoilAnalysis() { showToast(t("soilToast"), "success"); }
    function openWeatherAI() { showToast(t("weatherToast"), "success"); }
    function openDeposit() { showToast(t("depositToast"), "success"); }
    function openSend() { openMobileMoney(); }
    function openQR() { showToast(t("qrToast"), "success"); }
    function openNewListing() { showToast(t("newListingToast"), "success"); }
    function openScan() { openDiseaseScanner(); }
    function openChat() { showToast(t("chatToast"), "success"); }
    function startVideoCall() { showToast(t("videoToast"), "success"); }

    // Toast (type: success | error | info)
    function showToast(message, type = "info") {
      const container = document.getElementById("toastContainer");
      const toast = document.createElement("div");
      toast.className = `toast ${type}`;
      const icon =
        type === "success" ? "check-circle" :
        type === "error" ? "exclamation-circle" :
        "info-circle";

      toast.innerHTML = `
        <i class="fas fa-${icon}"></i>
        <span>${escapeHtml(message)}</span>
      `;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 4200);
    }

    // Close modals on outside click
    window.onclick = function(e) {
      if (e.target.classList && e.target.classList.contains("modal")) {
        e.target.classList.remove("active");
      }
    };

    /************************************************************
     * BADGE UNLOCKING (language-aware + persistent)
     ************************************************************/
    function hydrateBadges() {
      const badgesEl = document.getElementById("badges");
      if (!badgesEl) return;

      badgesEl.querySelectorAll(".badge-item").forEach(item => {
        const badgeId = item.getAttribute("data-badge");
        if (state.unlockedBadges.has(badgeId)) {
          item.classList.remove("locked");
        }
      });
    }

    function persistBadges() {
      localStorage.setItem("agri_unlocked_badges", JSON.stringify(Array.from(state.unlockedBadges)));
    }

    function attachBadgeClicks() {
      const badgesEl = document.getElementById("badges");
      if (!badgesEl) return;

      badgesEl.addEventListener("click", (e) => {
        const item = e.target.closest(".badge-item");
        if (!item) return;

        const badgeId = item.getAttribute("data-badge");
        const nameEl = item.querySelector("[data-i18n]");
        const badgeName = nameEl ? nameEl.textContent.trim() : badgeId;

        // If locked, unlock it on click (demo behavior)
        if (item.classList.contains("locked")) {
          item.classList.remove("locked");
          item.classList.add("unlock-anim");
          setTimeout(() => item.classList.remove("unlock-anim"), 600);

          state.unlockedBadges.add(badgeId);
          persistBadges();

          showToast(`${t("badgeUnlockedTitle")} ${t("badgeUnlockedMsg", { badge: badgeName })}`, "success");
        } else {
          // already unlocked
          showToast(t("badgeAlreadyUnlocked", { badge: badgeName }), "info");
        }
      });
    }

    /************************************************************
     * INITIAL RENDER (when language/currency loaded from storage)
     ************************************************************/
    // called inside window load, but safe as standalone too:
    function bootstrap() {
      setLanguage(state.lang);
      const curSel = document.getElementById("currency");
      if (curSel) curSel.value = state.currency;
      renderStats();
      hydrateBadges();
    }
  </script>
</body>
</html>
